<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0
  maximum-scale=1.0,minimum-scale=1.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <!-- <script src="./js/main.js" type="text/javascript"></script> -->
  <link rel="stylesheet" href="./css/style.css">
</head>

<body>
  <canvas id="canvas"></canvas>
  <div id="status222" class="status">
    <button id="eraserr">橡皮擦</button>
    <button id="brush">画笔</button>
  </div>
  <script>
    // window.alert("这是一个画 板");
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    setCanvasSize()
    drawAnderaser()

    /***************************             哈哈哈                ********************************/
      function drawAnderaser() {
        var painting = false
        var lastPoint = { x: undefined, y: undefined }
    if ('ontouchstart' in document.body) {
    //触摸设备
    canvas.ontouchstart = function (a) {
          var x = a.touches[0].clientX
          var y = a.touches[0].clientY
          eraserUsing = true
          if (eraserEnable) {
            eraser(x, y)
          } else {
            painting = true
            lastPoint = { x: x, y: y }
            drawCircle(x, y, 2)
          }
        }
    
        canvas.ontouchmove = function (b) {
          var x = b.touches[0].clientX
          var y = b.touches[0].clientY
          if (eraserEnable && eraserUsing) {
            eraser(x, y)
          } else {
            if (painting) {
              var newPoint = { x: x, y: y }
              drawCircle(x, y, 2)
              drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y)
              lastPoint = newPoint
            }
          }
        }
        canvas.ontouchend = function (c) {
          painting = false
          eraserUsing = false
        }

        var eraserEnable = false
        var eraserUsing = false
        eraserr.onclick = function () {
          eraserEnable = true
          status222.className = 'status x'
        }
        brush.onclick = function () {
          eraserEnable = false
          status222.className = 'status'
        }
    } else {
    //鼠标设备
        canvas.onmousedown = function (a) {
          var x = a.clientX
          var y = a.clientY
          eraserUsing = true
          if (eraserEnable) {
            eraser(x, y)
          } else {
            painting = true
            lastPoint = { x: x, y: y }
            drawCircle(x, y, 2)
          }
        }
    
        canvas.onmousemove = function (b) {
          var x = b.clientX
          var y = b.clientY
          if (eraserEnable && eraserUsing) {
            eraser(x, y)
          } else {
            if (painting) {
              var newPoint = { x: x, y: y }
              drawCircle(x, y, 2)
              drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y)
              lastPoint = newPoint
            }
          }
        }
        canvas.onmouseup = function (c) {
          painting = false
          eraserUsing = false
        }

        var eraserEnable = false
        var eraserUsing = false
        eraserr.onclick = function () {
          eraserEnable = true
          status222.className = 'status x'
        }
        brush.onclick = function () {
          eraserEnable = false
          status222.className = 'status'
        }
      }
    }
    //设置宽高
    function setCanvasSize() {
      function getSize() {
        var pageWidth = document.documentElement.clientWidth        //获得屏幕页面的宽高  ie还不支持
        var pageHeight = document.documentElement.clientHeight
        canvas.width = pageWidth
        canvas.height = pageHeight
      }
      getSize()
      //如果屏幕大小改变  就重新获取屏幕尺寸
      window.onresize = function () {
        getSize()
      }
    }
    //画圆  
    function drawCircle(x, y, radius) {
      context.beginPath()
      context.fillStyle = 'black'
      context.arc(x, y, radius, 0, Math.PI * 2)
      context.fill()
      console.log(context.fillstyle)
    }
    //画线
    function drawLine(x1, y1, x2, y2) {
      context.beginPath()
      context.moveTo(x1, y1)     //起点
      context.lineWidth = 5
      context.strokeStyle = 'black'
      context.lineTo(x2, y2)     //终点
      context.stroke()
      context.closePath()
    }

    //橡皮
    function eraser(x, y) {
      context.clearRect(x - 3, y - 3, 6, 6)
    }
  </script>
</body>

</html>